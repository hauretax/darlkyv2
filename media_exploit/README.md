# situation

The thing here is that it uses the image source to load the image. So you can directly create data in url.

when we clic on nsa image website open this page : 

## http://192.168.56.101/?page=media&src=nsa

we have a way to charge src we want so we can do xss attack

we try  http://192.168.56.101/?page=media&src=Montpellier<script>alert(document.cookie);</script> 

send to a page white sorry wrong answer + error 404 jpg

I think server read <script> and sanityze it. 

we can try to bypass that whith base 64 encoding:

it s explain her : https://owasp.org/www-community/attacks/xss/
at section : XSS Using Code Encoding
so we try : http://192.168.56.101/?page=media&src=data:text/html;base64,PHNjcmlwdD5hbGVydCgnY291Y291Jyk8L3NjcmlwdD4=
and give us that : THE FLAG IS : 928D819FC19405AE09921A2B71227BD9ABA106F9D2D37AC412E9E5A750F1506D

# probleme
the user can execute arbitrary js code on the server by sendig it in base 64 in url.


# fix

Dont use the url to choose the data you are going to load.
Check and sanityze requests you receive. 
The best in this case would have been t make a tab with images names and urls like in database.
